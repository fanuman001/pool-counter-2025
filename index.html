<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ± ç›´é€£ç‰ˆ v12</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; padding: 20px; }
        .player-card { border: 1px solid #444; padding: 10px; margin: 5px 0; display: flex; justify-content: space-between; align-items: center; }
        .btn { padding: 10px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
        #log { font-size: 12px; color: #888; background: #111; padding: 10px; margin-top: 20px; white-space: pre-wrap; }
    </style>
</head>
<body>

    <h2 id="status">ğŸ“¡ æ­£åœ¨ç›´é€£ä¼ºæœå™¨...</h2>
    <div id="player-list"></div>
    <div id="log">ç³»çµ±è¨ºæ–·æ—¥èªŒï¼š</div>

<script>
    const URL = 'https://nzuxyiefpenwuqudajdw.supabase.co/rest/v1/players?select=*';
    const KEY = 'sb_publishable_7y2n8zIopxlKEhcsJ05D2A_U89IFgae';
    const logEl = document.getElementById('log');

    function addLog(msg) {
        logEl.innerText += "\n" + new Date().toLocaleTimeString() + ": " + msg;
    }

    async function fetchData() {
        addLog("é–‹å§‹ç™¼èµ·è«‹æ±‚...");
        try {
            const response = await fetch(URL, {
                method: 'GET',
                headers: {
                    'apikey': KEY,
                    'Authorization': 'Bearer ' + KEY,
                    'Content-Type': 'application/json'
                }
            });

            addLog("ä¼ºæœå™¨å·²å›æ‡‰ï¼Œç‹€æ…‹ç¢¼: " + response.status);

            if (!response.ok) {
                const errText = await response.text();
                throw new Error("HTTP éŒ¯èª¤ " + response.status + ": " + errText);
            }

            const data = await response.json();
            addLog("æˆåŠŸè§£æ JSONï¼Œè³‡æ–™ç­†æ•¸: " + data.length);
            
            document.getElementById('status').innerText = "âœ… é€£ç·šæˆåŠŸ";
            render(data);

        } catch (error) {
            addLog("âŒ ç™¼ç”Ÿç•°å¸¸: " + error.message);
            document.getElementById('status').innerText = "âŒ é€£ç·šå¤±æ•—";
            document.getElementById('status').style.color = "red";
        }
    }

    function render(players) {
        const list = document.getElementById('player-list');
        list.innerHTML = players.map(p => `
            <div class="player-card">
                <span>${p.name.replace('OFF_','')}</span>
                <b style="color:#0f8">${p.money}</b>
            </div>
        `).join('');
    }

    // å•Ÿå‹•
    addLog("è…³æœ¬å·²å•Ÿå‹•ï¼Œç­‰å¾… 500ms å¾ŒåŸ·è¡Œ...");
    setTimeout(fetchData, 500);
</script>
</body>
</html>
